function V = ldg_basis_weight_matrix(pdeg)
%function V = ldg_basis_weight_matrix(pdeg)
%
% function returning the weight matrix which realizes an
% orthonormalization of the monomial basis on reference triangle.
% these strange matrices can be produced by basis_orthonormalizaton_matrix
% This matrix is used in ldg_evaluate_basis and ldg_evaluate_basis_derivative

% This program is open source.  For license terms, see the COPYING file.
%
% --------------------------------------------------------------------
% ATTRIBUTION NOTICE:
% This product includes software developed for the RBmatlab project at
% (C) Universities of Stuttgart and MÃ¼nster, Germany.
%
% RBmatlab is a MATLAB software package for model reduction with an
% emphasis on Reduced Basis Methods. The project is maintained by
% M. Dihlmann, M. Drohmann, B. Haasdonk, M. Ohlberger and M. Schaefer.
% For Online Documentation and Download we refer to www.morepas.org.
% --------------------------------------------------------------------


% Bernard Haasdonk 28.8.2009

switch pdeg
 case 0
  V = [sqrt(2)]; % 1.414213562373095
 case 1
%  V = eye(3);
 V = [     -4.083874453128224500e+000,      1.138649425635027700e-016,      1.149769303419852000e+000; ...
     5.987172385003169100e+000,     -3.464101615137750800e+000,      3.921311416545156800e-001; ...
     5.987172385003169100e+000,      3.464101615137750800e+000,      3.921311416545161200e-001; ...
];
 case 2
  V = [     -7.516583158368392900e+000,     -1.297993103973014500e-013,     -1.745263321631441300e+000,     -3.357520734339927100e+000,     -7.936112624608612200e-016,      1.087238741012490600e+000 ; ...
     2.936494704614870300e+001,      1.719370051606028200e+001,      5.274739831304837700e+000,      3.120422623592134400e+000,     -2.092047457404168800e+000,      3.741220907049305200e-001 ; ...
     2.936494704614938200e+001,     -1.719370051605942600e+001,      5.274739831305335100e+000,      3.120422623592130400e+000,      2.092047457404170100e+000,      3.741220907049306300e-001 ; ...
    -2.325673699495742500e+001,     -2.114488549810511800e+001,     -8.900039716516914700e+000,      3.142762377191384200e+000,     -1.701122356572524200e+000,      1.911073837077136600e-001 ; ...
    -5.172620241186029900e+001,      4.898674789513259400e-013,      1.424568323310254800e+001,      1.204773886708594400e+000,      3.089614331160541500e-015,      9.493761004140544000e-002 ; ...
    -2.325673699495817500e+001,      2.114488549810393900e+001,     -8.900039716517548900e+000,      3.142762377191379300e+000,      1.701122356572525500e+000,      1.911073837077136800e-001; ...
];
 case 3
  V = ...
      [      1.132785277321195800e+001,      4.232821090497361100e-013,      4.145585650802728700e+000,      2.972990120931153800e-013,     -6.303607897195036900e+000,     -2.018951754306727600e-014,     -2.253374799570846000e+000,     -2.923468511287095100e+000,     -1.103410291556824200e-015,      1.064909627642322700e+000; ...
	     -8.301898991949583700e+001,     -4.974961043396123000e+001,     -2.773920667750647300e+001,     -9.219497962365665000e+000,      2.022662028669521600e+001,      1.171067570014923500e+001,      4.944521533463261100e+000,      2.164236352150547700e+000,     -1.684397114754157700e+000,      3.678929777449820900e-001; ...
	     -8.301898991966491800e+001,      4.974961043397380000e+001,     -2.773920667745254000e+001,      9.219497962359904300e+000,      2.022662028669702700e+001,     -1.171067570014929700e+001,      4.944521533463206900e+000,      2.164236352150558300e+000,      1.684397114754159900e+000,      3.678929777449824700e-001; ...
	     1.522623151056798700e+002,      1.466792409168802700e+002,      8.757319161409243700e+001,      2.257481061447066800e+001,     -2.117012769526960300e+000,     -4.864541954905517300e+000,     -2.565753033426089400e+000,      2.454186289039805400e+000,     -1.383633385499313700e+000,      1.888044922491122500e-001; ...
	     3.719607111083237200e+002,      2.335999315756041700e-010,     -4.291965102040443700e+001,     -5.468593884448604700e-012,     -2.928101079883883500e+001,     -1.459969172259320100e-013,      8.077685912772890800e+000,      7.054431445344362400e-001,      8.183055376014940000e-017,      9.324767138020853600e-002; ...
	     1.522623151061978000e+002,     -1.466792409170688200e+002,      8.757319161393557700e+001,     -2.257481061444847400e+001,     -2.117012769530996200e+000,      4.864541954906162100e+000,     -2.565753033426167600e+000,      2.454186289039801000e+000,      1.383633385499314800e+000,      1.888044922491127500e-001; ...
	     -8.131780018602903200e+001,     -1.003237338725130500e+002,     -7.019029678758907700e+001,     -2.061711063752355600e+001,     -1.359610745982286100e+001,     -1.220502569958178200e+001,     -5.589713697994731100e+000,      2.150634311218392500e+000,     -1.058545467960053000e+000,      1.155186159177734200e-001; ...
	     -3.220361457266913000e+002,     -1.111860530802575100e+002,      4.156665907721706100e+001,      5.250935594785425300e+001,     -1.980313500963363200e+001,     -6.446413302440288100e-001,      3.549025491951538000e+000,      4.153657195056678100e-001,     -1.165160578934377500e-001,      3.783982305497007900e-002; ...
	     -3.220361457270681200e+002,      1.111860530798779600e+002,      4.156665907740754300e+001,     -5.250935594784708400e+001,     -1.980313500962888500e+001,      6.446413302436051500e-001,      3.549025491951608200e+000,      4.153657195056723000e-001,      1.165160578934377300e-001,      3.783982305497035600e-002; ...
	     -8.131780018639574300e+001,      1.003237338727129100e+002,     -7.019029678749100800e+001,      2.061711063750497900e+001,     -1.359610745982105100e+001,      1.220502569958137500e+001,     -5.589713697994565900e+000,      2.150634311218374300e+000,      1.058545467960051000e+000,      1.155186159177734300e-001; ...
      ];
 case 4
    V= ...
[     -1.547075657804519000e+001,      5.139224001794331100e-010,     -7.207112124829085300e+000,     -5.262877698951778200e-011,      8.796536841856337200e+000,     -4.110219744403428500e+000,     -2.286107268995340300e-013,      4.520598701282865200e+000,      1.544534114716066100e-013,     -5.421202148988813400e+000,      1.393770119123634100e-014,     -2.574742949849764700e+000,      2.621633477104632300e+000,      5.840951564396555200e-016,      1.054869788382086300e+000; ...
     1.816063045537666200e+002,     -1.064534353029047700e+002,      7.982335730776809200e+001,      4.313374793326517700e+001,     -5.555397252095847400e+001,      2.858375227356238600e+001,     -3.624029640281969500e+001,     -2.405961409163528200e+001,     -1.057181519635582300e+001,      1.547848540722756100e+001,      8.931685410983458700e+000,      4.767580338983981900e+000,     -1.671917039391563900e+000,      1.499513119448038400e+000,      3.651564205555907800e-001; ...
     1.816063046103416000e+002,      1.064534352914985600e+002,      7.982335730538298400e+001,     -4.313374793208192400e+001,     -5.555397252110170600e+001,      2.858375227359208300e+001,      3.624029640283109200e+001,     -2.405961409162821200e+001,      1.057181519635320100e+001,      1.547848540722793200e+001,     -8.931685410983583000e+000,      4.767580338983921500e+000,     -1.671917039391567400e+000,     -1.499513119448039600e+000,      3.651564205555911100e-001; ...
    -5.688287868315366000e+002,      5.496617683121820600e+002,     -4.015809054843035100e+002,     -2.112736420088037300e+002,      5.046512741461976500e+001,     -6.529980581005462200e+001,      7.582027578415792800e+001,      4.753623791046027200e+001,      1.685214549385079500e+001,      3.356420127510865400e+000,     -1.068654076544853300e+000,     -6.941523632838267900e-001,     -2.077769071968650600e+000,      1.240014967400874900e+000,      1.879356440543587000e-001; ...
    -1.479140274457026400e+003,      8.876920412759539300e-008,      2.485363740510907200e+001,      1.198740072719388800e-009,      2.560601051470575300e+002,     -5.296008217651535000e+001,      6.652808456178954300e-011,     -2.041234334784981600e+001,     -3.188628886556284700e-012,     -2.488821780550812000e+001,     -1.446328887430959600e-013,      6.204595051379747900e+000,     -4.524693823156915000e-001,      3.436165365185855800e-017,      9.242475515156103900e-002; ...
    -5.688287871246851600e+002,     -5.496617683006251100e+002,     -4.015809054728918600e+002,      2.112736420022239400e+002,      5.046512741521667800e+001,     -6.529980580995658100e+001,     -7.582027578425999100e+001,      4.753623791045427500e+001,     -1.685214549384366800e+001,      3.356420127511135800e+000,      1.068654076545092300e+000,     -6.941523632838420000e-001,     -2.077769071968650100e+000,     -1.240014967400876500e+000,      1.879356440543590900e-001; ...
     6.743236120913769600e+002,     -8.453424566744495200e+002,      7.007134696482206700e+002,      3.832914337945438800e+002,      5.988239200746458800e+001,      5.624370438948221800e+001,      1.673973662621129000e+001,      7.386122928729128600e+000,      2.064303895139195000e+000,     -5.566698259510689100e+000,     -6.198102930717598500e+000,     -3.147647226089904700e+000,     -1.892173872064784300e+000,      9.545526904372375600e-001,      1.153029499377741500e-001; ...
     2.924588699681011800e+003,     -1.077735587211609300e+003,     -8.503432651687956000e+001,     -2.445657504835047000e+002,     -1.082828009040820500e+002,     -1.987981151620481800e+001,     -5.290464154570514000e+001,      1.477104755205622400e+001,      2.438604738971371300e+001,     -1.561275664390729300e+001,      8.408216773676674400e-002,      2.774952834734024900e+000,     -2.889418888639215800e-001,      1.038765662795118300e-001,      3.753751641669838400e-002; ...
     2.924588700291614300e+003,      1.077735586867789800e+003,     -8.503432657253982500e+001,      2.445657504790267200e+002,     -1.082828009045984600e+002,     -1.987981151468397900e+001,      5.290464154568072500e+001,      1.477104755211477500e+001,     -2.438604738971558600e+001,     -1.561275664390651700e+001,     -8.408216773689757000e-002,      2.774952834734022700e+000,     -2.889418888639220300e-001,     -1.038765662795117900e-001,      3.753751641669842600e-002; ...
     6.743236125397506800e+002,      8.453424566952011200e+002,      7.007134696355481100e+002,     -3.832914337826734400e+002,      5.988239200667345600e+001,      5.624370438880868100e+001,     -1.673973662607932400e+001,      7.386122928692350900e+000,     -2.064303895134540000e+000,     -5.566698259513111100e+000,      6.198102930717869400e+000,     -3.147647226089914000e+000,     -1.892173872064781600e+000,     -9.545526904372387800e-001,      1.153029499377743500e-001; ...
    -2.719661430441021300e+002,      4.041272299075200700e+002,     -3.776136548230976500e+002,     -2.238133030401662600e+002,     -6.739187887338764000e+001,     -2.358123131472624200e+001,     -6.022306574635791800e+001,     -4.322733883346177200e+001,     -1.559223802655422900e+001,     -1.036939610326688300e+001,     -8.264406163375637600e+000,     -3.978502880785887500e+000,     -1.625753657566444600e+000,      7.426270623790403000e-001,      7.822979175865757400e-002; ...
    -1.660507979119712900e+003,      1.068100103551620800e+003,     -1.364388567844685600e+002,      2.542880935943160000e+002,     -9.030960322372185100e+001,      1.948806053667472000e+002,     -5.997755715357715200e+001,      1.640620941828743200e+001,      2.241327060301570700e+001,     -9.631916096375915600e+000,     -2.535555972790730100e-001,      1.196466177187194300e+000,     -2.109260989737115100e-001,      9.062734264527644300e-002,      1.904575114472694200e-002; ...
    -2.785834161744947300e+003,      1.962914304958570200e-007,      5.583068108239017400e+002,      8.975988141643895000e-009,     -2.414011889248409700e+002,     -1.836910704391419000e+002,      8.672819062253187300e-011,      1.173482608798020300e+001,      1.534642788975243700e-012,     -8.076840923946823700e+000,     -6.385425354623736700e-014,      1.278036733733552300e+000,     -9.760924101545780100e-002,      2.079583589171370000e-016,      1.258432377763526800e-002; ...
    -1.660507979726722600e+003,     -1.068100103391280500e+003,     -1.364388567300320600e+002,     -2.542880935981018500e+002,     -9.030960322337270400e+001,      1.948806053655552500e+002,      5.997755715334856300e+001,      1.640620941830673400e+001,     -2.241327060300829300e+001,     -9.631916096371369900e+000,      2.535555972790156100e-001,      1.196466177187211600e+000,     -2.109260989737131700e-001,     -9.062734264527583200e-002,      1.904575114472718500e-002; ...
    -2.719661432565120500e+002,     -4.041272299300729300e+002,     -3.776136548199055500e+002,      2.238133030338735200e+002,     -6.739187887304888100e+001,     -2.358123131415133500e+001,      6.022306574633327600e+001,     -4.322733883342935700e+001,      1.559223802654292400e+001,     -1.036939610326571600e+001,      8.264406163375309000e+000,     -3.978502880785734300e+000,     -1.625753657566433300e+000,     -7.426270623790396400e-001,      7.822979175865764400e-002; ...
];
 otherwise
  error('desired pdeg not yet supported')
end;%| \docupdate 
